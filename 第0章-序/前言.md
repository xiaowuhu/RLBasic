
# 前言

2022年11月，ChatGPT 的出现让大家知道了什么是大语言模型，它惊人的能力在很多方面让人类都自叹不如。同时，强化学习这个概念也普及到了更多的人，因为训练 ChatGPT 的过程中使用了强化学习中的近端策略优化算法和环境。但是在市面上，与机器学习及深度学习相比，强化学习的资料很不系统。

笔者在微软亚洲研究院工作时，程骉博士送给笔者一本《强化学习》，就是 Richard S. Sutton 的那本堪称强化学习圣经的经典书籍。但是，实话实说，笔者在看书自学过程中感觉很吃力，后来总结出原因有以下几点：

- 开篇就进入马尔科夫决策过程与动态规划的讲解，缺乏很多知识点作为铺垫；

- 没有给出配套代码，直接阅读公式的学习难度很大，不能理解透彻甚至不理解；

- 有些细节没有讲到，可能是因为在作者看来不值一提，但是会给读者带来困扰。

其它学习资料，如伦敦大学 David Silver 教授的课件、台湾大学李宏毅教授的视频课程等，具有专业和权威的特点，但知识点密度太大，读者可能会消化不良。懂的人一看就懂，不懂的人看了很多遍还是不懂。而网上的其它一些资料，基本上都是人云亦云、复制粘贴，毫无参考价值。于是，笔者决定边学习边记录，把那些困扰笔者的知识点及算法代码、试验步骤都记录下来，形成了初期的文字积累，然后试图使用费曼学习法来把它们整理成册。

强化学习的学习路径应该是这样的：强化学习基础知识、深度强化学习知识、强化学习的前沿分支（如多智能体强化学习）。本书侧重在强化学习基础知识上，以及学习强化学习所需要的基本数学知识。从笔者自己的学习路径看，这些基础知识是必须的，就好比不学习加减乘除，也无法理解微积分。

所以，本书命名为《智能之门：强化学习基础》，分为十二章，按阶段划分成四步。我们在每一章的开始都会提出一个问题，问题本身往往是简单直接的，但解决这个问题并不是我们的目的，而是要引出其背后的强化学习方法与原理。

以下是内容提要，每一步、每一章都是对前面知识的升级和扩展，形成完整无缺的知识体系和平滑的学习路线。

第一步，策略选择与强化学习。

- 第 1 章，概率统计与决策。这一章只是个引子，通过解决蒙提霍尔问题，把读者从熟悉的**概率统计带入策略选择**的强化学习领域。

第二步，马尔可夫过程与奖励。

- 第 2 章，转移概率矩阵。通过解决租车还车问题，从第 1 章**静态的概率计算升级到动态的转移概率**，形成强化学习的数学基础。

- 第 3 章，马尔可夫过程。通过解决醉汉回家问题，从第 2 章的**状态堆叠升级到过程形成**，形成强化学习的理论基础。

- 第 4 章，马尔可夫奖励过程。通过解决安全驾驶问题，从第 3 章的**普通过程升级到奖励过程**，引入价值函数的概念并给出评估方法。

第三步，动态规划与贝尔曼方程。

- 第 5 章，状态价值函数与贝尔曼方程。通过使用贝尔曼方程解决开发流程问题，从第 4 章的**价值估算升级到价值计算**。

- 第 6 章，动作价值函数与贝尔曼期望方程。通过使用贝尔曼期望方程解决射击气球问题，从第 5 章的**状态价值升级到动作价值**，并产生了现代的强化学习模型。

- 第7章，策略选择与贝尔曼最优方程。通过使用贝尔曼期望方程解决穿越虫洞问题，从第 6 章的**动作价值升级到最优价值**，**从固定策略和随机策略升级到最优策略**。

第四步，蒙特卡洛与时序差分。

- 第 8 章，探索与利用的平衡。从第三步的**动态规划升级到蒙特卡洛方法**，解决多臂强盗问题，并介绍了强化学习的研究目标之一，即探索与利用的平衡。

- 第 9 章，蒙特卡洛方法。从第 8 章的**有模型升级到无模型**，解决冰面滑行问题。

- 第 10 章，单步时序差分。从第 9 章的**分幕计算升级到分步计算**，解决悬崖漫步问题。

- 第 11 章，多步时序差分。从第 10 章的**单步计算升级到多步计算**，解决规划与学习的统一问题。

- 第12章，表格学习问题实际上是对全书的总结。

全书严格按照从简到难的方式来组织强化学习知识体系，并非单纯的理论知识讲解和公式堆砌，而是从十一个问题出发，逐步带领读者进入强化学习的世界，带着问题学习强化学习的基本知识，并针对每个知识点进行了深度的挖掘，以达到彻底理解该知识点的目的。每一章都配有文字讲解、实例化公式推导、丰富的图片说明、可以运行的代码、试验结果解读等，并有“思考与练习”来鼓励读者自己动手完成试验项目，特别是其中精心设计的【大作业】题，以期达成“做中学”的最佳实践。所以，本书即适合于作为教材使用，也可以供社会读者自学。

章节的标题后带有【电子资源】的表示为扩展阅读部分，不随本书印刷，读者可以在线阅读电子文档。

关于深度强化学习知识，将会在后续的《智能之门：深度强化学习》一书中讲解。

### 关于本书的封面

本书的封面为绿色，向微软的 XBox 产品致敬。封面上是一把乐队常用的电贝司（BASS），它的四根弦代表了本书中的四步，它们的含义是：

- 第一根弦是 Basic（基础），最低的重音，真正的基础，它讲解了强化学习产生、存在的必然性。

- 第二根弦是 Accent（重音），重点强调了马尔可夫过程，这是强化学习的基础理论。

- 第三根弦是 Soul（灵魂），因为动态规划与贝尔曼方程是强化学习的灵魂。

- 第四根弦是 Solo（独奏），最高的重音，乐手经常在这根弦上进行 Solo，代表蒙特卡洛与时序差分独步天下的地位。
