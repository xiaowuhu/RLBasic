
## 4.1 安全驾驶问题

道路交通事故的发生，是由于“车辆、驾驶员、道路交通环境”三者之间关系的不协调、不稳定状态造成的。因此，车辆、驾驶员和道路交通环境是引起行车事故的三大基本因素。

**问题：如果一个新手或者一个智能体，要通过强化学习来训练其安全驾驶意识，应该如何建模？**

###  建立模型

以一个人类司机驾车上路为例，我们可根据日常驾驶经验以及在路上遇到的各种路况来建立一个模型。图 4.1.1 是一个有关安全驾驶的模型。当然，读者也可以根据自己的理解建立不同的模型。

<img src="./img/SafetyDrive-Model.png" width=460>

图 4.1.1 安全驾驶问题的状态转移概率图

表 4.1.1 是各个状态的说明。

表 4.1.1 状态说明

|状态|简要说明|概率：状态转移|
|-|-|-|
|S：出发|起点。|0.9：进入正常行驶状态<br>0.1：可能有急事而超速行驶|
|N：正常行驶|正常行驶是标准状态，<br>但是由于各种车况、<br>路况、人况，可能会<br>转移到其它几个状态。|0.1：由于路况好或与他人斗气飙车<br>0.1：开车时心不在焉，在路口闯灯<br>0.2：斑马线前礼让行人<br> 0.1：开到闹市时减速行驶<br>0.1：开车时打电话<br>  0.3：进入居民区后减速行驶<br>0.1：安全抵达目的地|
|M：接打手机|指的是开车过程中接打手机，<br>属于危险行为。|0.6：结束通话返回正常行驶<br>0.4：发生事故|
|P：礼让行人|在斑马线礼让行人。|1.0：回到正常行驶状态||
|L：小区慢行|进入小区车速在5公里以下。|1.0：安全抵达终点|
|G：安全抵达|安全抵达目的地。|1.0：进入结束状态|
|D：闹市减速|在闹市低速行驶，注意来往<br>行人车俩，禁止鸣笛。|0.3：礼让行人<br> 0.7：回到正常行驶状态|
|X：超速行驶|属于危险驾驶行为，<br>“十次事故九次快”。|0.2：回到正常行驶<br>0.3：闯红灯<br>0.5：发生事故|
|R：路口闯灯|闯红灯或不按交警指挥行驶。|0.9：出事故<br>0.1：侥幸回到正常行驶|
|C：发生事故|车撞车、车撞人、车撞物。|1.0：结束，不能再达到目的地|
|E：结束|终止状态。|进入此状态后将不再进行转移|

有的读者可能会认为：进入小区慢行状态后，就一定可以安全抵达吗？当然，在小区里可能会有很多突发情况，比如老人儿童突然横穿道路等。在此我们就不再细化这个模型了。

在图 4.1.1 中，“安全抵达”和“发生事故”都可以做为终止状态，为什么还有一个单独的“结束”状态呢？这涉及到了本章后面要学习的状态价值函数的一些规则（终止状态的价值必须为 0），请读者继续阅读。
